<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prototipe Ujian Online</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100">
    <!-- Halaman Login -->
    <div id="login-page" class="min-h-screen flex items-center justify-center p-4">
        <div class="bg-white rounded-lg shadow-lg p-8 max-w-md w-full">
            <h2 class="text-1xl font-bold text-center text-gray-300 mb-6">Prototipe Ujian Online</h2>
            <h3 class="text-3xl font-bold text-center text-indigo-700 mb-6">Login Siswa</h3>
            <div id="error-login" class="hidden bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4">
                Username atau password salah
            </div>
            <form id="login-form" class="space-y-4">
                <div>
                    <label for="username" class="block text-sm font-medium text-gray-700 mb-1">Username</label>
                    <input type="text" id="username" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500" placeholder="Masukkan username Anda" required>
                </div>
                <div>
                    <label for="password" class="block text-sm font-medium text-gray-700 mb-1">Password</label>
                    <input type="password" id="password" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500" placeholder="Masukkan password Anda" required>
                </div>
                <div>
                    <button type="submit" class="w-full bg-indigo-600 text-white py-2 px-4 rounded-lg font-medium hover:bg-indigo-700 transition duration-200">
                        Masuk
                    </button>
                </div>
            </form>
            <div class="mt-4 text-center text-sm text-gray-600">
                <p>Kredensial demo: username: <strong>siswa1</strong>, password: <strong>password</strong></p>
            </div>
        </div>
    </div>

    <!-- Halaman Pengumuman -->
    <div id="announcement-page" class="min-h-screen hidden flex items-center justify-center p-4">
        <div class="bg-white rounded-lg shadow-lg p-8 max-w-2xl w-full">
            <h1 class="text-3xl font-bold text-center text-indigo-700 mb-6">Pengumuman Penting</h1>
            <div class="space-y-4 mb-8">
                <p class="text-gray-700">Selamat datang di Sistem Ujian Online. Silakan baca instruksi berikut dengan saksama sebelum melanjutkan:</p>
                <ul class="list-disc pl-5 space-y-2 text-gray-700">
                    <li>Pastikan Anda memiliki koneksi internet yang stabil selama ujian.</li>
                    <li>Jangan me-refresh halaman atau berpindah halaman selama ujian berlangsung.</li>
                    <li>Semua pertanyaan harus dijawab dalam batas waktu yang diberikan.</li>
                    <li>Setelah Anda mengirimkan ujian, Anda tidak dapat melakukan perubahan.</li>
                    <li>Gunakan tombol navigasi untuk berpindah antar pertanyaan.</li>
                    <li>Pastikan untuk meninjau semua jawaban Anda sebelum mengirimkan.</li>
                    <li>Segala bentuk kecurangan akan mengakibatkan diskualifikasi.</li>
                    <li>Masalah teknis harus segera dilaporkan kepada pengawas ujian.</li>
                </ul>
                <p class="text-gray-700 mt-4">Dengan melanjutkan, Anda menyatakan telah membaca dan memahami semua instruksi di atas.</p>
            </div>
            <div class="text-center">
                <button id="continue-btn" class="bg-indigo-600 text-white px-6 py-3 rounded-lg font-medium hover:bg-indigo-700 transition duration-200">
                    Mulai Ujian
                </button>
            </div>
        </div>
    </div>

    <!-- Halaman Ujian -->
    <div id="exam-page" class="min-h-screen hidden flex flex-col">
        <!-- Navigasi Atas -->
        <header class="bg-white shadow-sm p-4">
            <div class="container mx-auto flex justify-between items-center">
                <div class="text-lg font-semibold text-gray-800">UjianOnline</div>
                <div id="timer" class="text-xl font-bold text-red-600">30:00</div>
                <button id="end-exam-btn" class="bg-red-500 text-white px-4 py-2 rounded-lg font-medium hover:bg-red-600 transition duration-200">
                    Akhiri Ujian
                </button>
            </div>
        </header>

        <!-- Konten Utama -->
        <main class="flex-1 container mx-auto p-4 flex">
            <!-- Bagian Pertanyaan -->
            <div class="flex-1 bg-white rounded-lg shadow-sm p-6">
                <div class="mb-6">
                    <h2 class="text-xl font-semibold text-gray-800 mb-2">Pertanyaan <span id="current-question">1</span></h2>
                    <p id="question-text" class="text-gray-700">Berapa nilai π (pi) yang dibulatkan ke dua desimal?</p>
                </div>
                
                <div id="options-container" class="space-y-3">
                    <!-- Opsi akan diisi oleh JavaScript -->
                </div>
            </div>

            <!-- Panel Grid Pertanyaan (Terlihat di layar besar) -->
            <div id="questions-drawer" class="hidden lg:block w-80 ml-6 bg-white rounded-lg shadow-sm p-4">
                <h3 class="text-lg font-semibold text-gray-800 mb-4">Daftar Pertanyaan</h3>
                <div id="questions-grid" class="grid grid-cols-5 gap-3">
                    <!-- Nomor pertanyaan akan diisi oleh JavaScript -->
                </div>
            </div>
        </main>

        <!-- Footer Tetap -->
        <footer class="bg-white border-t p-4 sticky bottom-0">
            <div class="container mx-auto flex justify-between items-center">
                <button id="prev-btn" class="bg-gray-300 text-gray-700 px-4 py-2 rounded-lg font-medium hover:bg-gray-400 transition duration-200 disabled:bg-gray-300 disabled:text-gray-500 disabled:opacity-50 disabled:cursor-not-allowed" disabled>
                    Sebelumnya
                </button>
                
                <button id="info-btn" class="bg-indigo-100 text-indigo-700 px-4 py-2 rounded-lg font-medium hover:bg-indigo-200 transition duration-200 lg:hidden">
                    <span id="question-info">1/35</span>
                </button>
                
                <button id="next-btn" class="bg-indigo-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-indigo-700 transition duration-200">
                    Selanjutnya
                </button>
            </div>
        </footer>
    </div>

    <!-- Modal Konfirmasi -->
    <div id="confirmation-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50">
        <div class="bg-white rounded-lg shadow-xl p-6 max-w-md w-full mx-4">
            <h3 class="text-xl font-semibold text-gray-800 mb-4">Konfirmasi Akhiri Ujian</h3>
            <p class="text-gray-700 mb-6">Apakah Anda yakin ingin mengakhiri ujian? Tindakan ini tidak dapat dibatalkan.</p>
            <div class="flex justify-end space-x-3">
                <button id="cancel-btn" class="bg-gray-300 text-gray-700 px-4 py-2 rounded-lg font-medium hover:bg-gray-400 transition duration-200">
                    Batal
                </button>
                <button id="confirm-end-btn" class="bg-red-500 text-white px-4 py-2 rounded-lg font-medium hover:bg-red-600 transition duration-200">
                    Akhiri Ujian
                </button>
            </div>
        </div>
    </div>

    <!-- Panel Pertanyaan Mobile (Actionsheet) -->
    <div id="mobile-drawer" class="fixed inset-x-0 bottom-0 bg-white rounded-t-xl shadow-lg transform transition-transform duration-300 translate-y-full z-40">
        <div class="p-4">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-semibold text-gray-800">Informasi Ujian</h3>
                <button id="close-drawer-btn" class="text-gray-500 hover:text-gray-700">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>
            
            <!-- Informasi Siswa dan Ujian -->
            <div class="mb-6 space-y-3">
                <div class="flex justify-between">
                    <span class="text-gray-700">Siswa:</span>
                    <span class="font-medium" id="student-name">John Doe</span>
                </div>
                <div class="flex justify-between">
                    <span class="text-gray-700">Kelas:</span>
                    <span class="font-medium" id="class-info">Kelas 10-A</span>
                </div>
                <div class="flex justify-between">
                    <span class="text-gray-700">Mata Pelajaran:</span>
                    <span class="font-medium" id="subject-info">Matematika</span>
                </div>
                <div class="flex justify-between">
                    <span class="text-gray-700">Ujian:</span>
                    <span class="font-medium" id="exam-info">Ujian Akhir Semester</span>
                </div>
            </div>
            
            <h4 class="text-md font-semibold text-gray-800 mb-3">Daftar Pertanyaan</h4>
            <div id="mobile-questions-grid" class="grid grid-cols-5 gap-3 max-h-64 overflow-y-auto">
                <!-- Nomor pertanyaan akan diisi oleh JavaScript -->
            </div>
        </div>
    </div>

    <!-- Halaman Hasil -->
    <div id="result-page" class="min-h-screen hidden flex items-center justify-center p-4">
        <div class="bg-white rounded-lg shadow-lg p-8 max-w-4xl w-full">
            <h1 class="text-3xl font-bold text-center text-indigo-700 mb-6">Hasil Ujian</h1>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                <div class="bg-indigo-50 p-6 rounded-lg">
                    <h2 class="text-xl font-semibold text-indigo-700 mb-4">Informasi Siswa</h2>
                    <div class="space-y-2">
                        <div class="flex justify-between">
                            <span class="text-gray-700">Nama:</span>
                            <span class="font-medium" id="result-student-name">John Doe</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-700">Kelas:</span>
                            <span class="font-medium" id="result-class">Kelas 10-A</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-700">Mata Pelajaran:</span>
                            <span class="font-medium" id="result-subject">Matematika</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-700">Ujian:</span>
                            <span class="font-medium" id="result-exam">Ujian Akhir Semester</span>
                        </div>
                    </div>
                </div>
                
                <div class="bg-green-50 p-6 rounded-lg">
                    <h2 class="text-xl font-semibold text-green-700 mb-4">Kinerja Ujian</h2>
                    <div class="space-y-2">
                        <div class="flex justify-between">
                            <span class="text-gray-700">Total Pertanyaan:</span>
                            <span class="font-medium" id="total-questions">35</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-700">Dijawab:</span>
                            <span class="font-medium" id="answered-questions">0</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-700">Jawaban Benar:</span>
                            <span class="font-medium" id="correct-answers">0</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-700">Nilai:</span>
                            <span class="font-medium text-xl text-green-700" id="score">0%</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="mb-8">
                <h2 class="text-xl font-semibold text-gray-800 mb-4">Tinjauan Pertanyaan</h2>
                <div id="question-review" class="space-y-4">
                    <!-- Tinjauan pertanyaan akan diisi oleh JavaScript -->
                </div>
            </div>
            
            <div class="text-center">
                <button id="back-to-login-btn" class="bg-indigo-600 text-white px-6 py-3 rounded-lg font-medium hover:bg-indigo-700 transition duration-200">
                    Kembali ke Login
                </button>
            </div>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>

    <script>
        // Data pertanyaan contoh - 35 pertanyaan dengan teks dummy
        const questions = [
            {
                id: 1,
                text: "Berapa nilai π (pi) yang dibulatkan ke dua desimal?",
                options: ["3.14", "3.16", "3.12", "3.18"],
                correctAnswer: 0
            },
            {
                id: 2,
                text: "Berapa akar kuadrat dari 64?",
                options: ["6", "7", "8", "9"],
                correctAnswer: 2
            },
            {
                id: 3,
                text: "Berapa hasil dari 15 × 3?",
                options: ["35", "40", "45", "50"],
                correctAnswer: 2
            },
            {
                id: 4,
                text: "Manakah dari berikut ini yang merupakan bilangan prima?",
                options: ["12", "15", "17", "20"],
                correctAnswer: 2
            },
            {
                id: 5,
                text: "Berapa 25% dari 200?",
                options: ["25", "50", "75", "100"],
                correctAnswer: 1
            },
            {
                id: 6,
                text: "Selesaikan untuk x: 2x + 5 = 15",
                options: ["5", "10", "15", "20"],
                correctAnswer: 0
            },
            {
                id: 7,
                text: "Berapa luas persegi panjang dengan panjang 8 dan lebar 5?",
                options: ["13", "26", "40", "45"],
                correctAnswer: 2
            },
            {
                id: 8,
                text: "Berapa 3 pangkat 4?",
                options: ["12", "27", "64", "81"],
                correctAnswer: 3
            },
            {
                id: 9,
                text: "Berapa angka berikutnya dalam urutan: 2, 4, 8, 16, ...?",
                options: ["24", "28", "32", "36"],
                correctAnswer: 2
            },
            {
                id: 10,
                text: "Berapa jumlah sudut dalam segitiga?",
                options: ["90°", "180°", "270°", "360°"],
                correctAnswer: 1
            },
            {
                id: 11,
                text: "Apa rumus keliling lingkaran?",
                options: ["2πr", "πr²", "πd", "Baik 2πr dan πd"],
                correctAnswer: 3
            },
            {
                id: 12,
                text: "Manakah dari berikut ini yang bukan persamaan kuadrat?",
                options: ["x² + 3x + 2 = 0", "2x - 5 = 0", "3x² - 7x + 1 = 0", "x² - 4 = 0"],
                correctAnswer: 1
            },
            {
                id: 13,
                text: "Berapa nilai 5! (5 faktorial)?",
                options: ["25", "60", "120", "125"],
                correctAnswer: 2
            },
            {
                id: 14,
                text: "Manakah dari berikut ini yang merupakan bilangan irasional?",
                options: ["√4", "√9", "√2", "√16"],
                correctAnswer: 2
            },
            {
                id: 15,
                text: "Berapa kemiringan garis y = 3x + 2?",
                options: ["2", "3", "5", "1"],
                correctAnswer: 1
            },
            {
                id: 16,
                text: "Berapa nilai sin(90°)?",
                options: ["0", "0.5", "1", "Tidak terdefinisi"],
                correctAnswer: 2
            },
            {
                id: 17,
                text: "Manakah dari berikut ini yang merupakan rumus volume silinder?",
                options: ["πr²h", "2πrh", "πr²", "2πr² + 2πrh"],
                correctAnswer: 0
            },
            {
                id: 18,
                text: "Berapa turunan dari x²?",
                options: ["x", "2x", "2", "x³/3"],
                correctAnswer: 1
            },
            {
                id: 19,
                text: "Berapa integral dari 2x dx?",
                options: ["x²", "x² + C", "2x²", "2x² + C"],
                correctAnswer: 1
            },
            {
                id: 20,
                text: "Manakah dari berikut ini yang merupakan tripel Pythagoras?",
                options: ["3, 4, 5", "2, 3, 4", "5, 6, 7", "7, 8, 9"],
                correctAnswer: 0
            },
            {
                id: 21,
                text: "Berapa nilai log₁₀100?",
                options: ["1", "2", "10", "100"],
                correctAnswer: 1
            },
            {
                id: 22,
                text: "Manakah dari berikut ini yang merupakan rumus kuadrat?",
                options: ["x = -b ± √(b² - 4ac)/2a", "x = b ± √(b² - 4ac)/2a", "x = -b ± √(b² + 4ac)/2a", "x = b ± √(b² + 4ac)/2a"],
                correctAnswer: 0
            },
            {
                id: 23,
                text: "Berapa nilai 8 ÷ 2(2 + 2)?",
                options: ["1", "16", "8", "4"],
                correctAnswer: 1
            },
            {
                id: 24,
                text: "Manakah dari berikut ini yang merupakan rumus bunga majemuk?",
                options: ["P(1 + r/n)^(nt)", "P + (P × r × t)", "P(1 + rt)", "P/(1 + r)^t"],
                correctAnswer: 0
            },
            {
                id: 25,
                text: "Berapa probabilitas mendapatkan kepala saat melempar koin yang adil?",
                options: ["0", "0.25", "0.5", "1"],
                correctAnswer: 2
            },
            {
                id: 26,
                text: "Manakah dari berikut ini yang merupakan rumus luas segitiga?",
                options: ["1/2 × alas × tinggi", "alas × tinggi", "πr²", "2 × (panjang + lebar)"],
                correctAnswer: 0
            },
            {
                id: 27,
                text: "Berapa nilai tan(45°)?",
                options: ["0", "1", "√2", "Tidak terdefinisi"],
                correctAnswer: 1
            },
            {
                id: 28,
                text: "Manakah dari berikut ini yang merupakan rumus suku ke-n dari barisan aritmatika?",
                options: ["a + (n-1)d", "a × r^(n-1)", "n/2 × (2a + (n-1)d)", "a(1 - r^n)/(1 - r)"],
                correctAnswer: 0
            },
            {
                id: 29,
                text: "Berapa nilai 2³ × 2²?",
                options: ["2^5", "2^6", "4^5", "4^6"],
                correctAnswer: 0
            },
            {
                id: 30,
                text: "Manakah dari berikut ini yang merupakan rumus jumlah sudut dalam poligon?",
                options: ["(n-2) × 180°", "n × 180°", "(n-2) × 90°", "n × 90°"],
                correctAnswer: 0
            },
            {
                id: 31,
                text: "Berapa nilai 0! (nol faktorial)?",
                options: ["0", "1", "Tidak terdefinisi", "∞"],
                correctAnswer: 1
            },
            {
                id: 32,
                text: "Manakah dari berikut ini yang merupakan rumus jarak antara dua titik (x₁,y₁) dan (x₂,y₂)?",
                options: ["√((x₂-x₁)² + (y₂-y₁)²)", "(x₂-x₁) + (y₂-y₁)", "√(x₂² + y₂²) - √(x₁² + y₁²)", "(x₂-x₁) × (y₂-y₁)"],
                correctAnswer: 0
            },
            {
                id: 33,
                text: "Berapa nilai i² (di mana i adalah unit imajiner)?",
                options: ["1", "-1", "i", "-i"],
                correctAnswer: 1
            },
            {
                id: 34,
                text: "Manakah dari berikut ini yang merupakan rumus volume bola?",
                options: ["4/3 πr³", "πr²h", "2πr²", "4πr²"],
                correctAnswer: 0
            },
            {
                id: 35,
                text: "Berapa nilai lim(x→0) sin(x)/x?",
                options: ["0", "1", "∞", "Tidak terdefinisi"],
                correctAnswer: 1
            }
        ];

        // State saat ini
        let currentQuestionIndex = 0;
        let answers = new Array(questions.length).fill(null);
        let timeLeft = 30 * 60; // 30 menit dalam detik
        let timerInterval;
        let studentInfo = {
            name: "John Doe",
            class: "Kelas 10-A",
            subject: "Matematika",
            exam: "Ujian Akhir Semester"
        };

        // Inisialisasi aplikasi
        $(document).ready(function() {
            // Generate grid pertanyaan
            generateQuestionGrid();
            
            // Tampilkan pertanyaan pertama
            showQuestion(currentQuestionIndex);
            
            // Mulai timer
            startTimer();
            
            // Set info siswa
            setStudentInfo();

            $('#login-form').submit(function(e) {
                e.preventDefault();
                // Validasi sederhana - dalam aplikasi nyata, ini akan dicek terhadap server
                const username = $('#username').val();
                const password = $('#password').val();
                
                if (username === 'siswa1' && password === 'password') {
                    $('#login-page').addClass('hidden');
                    $('#announcement-page').removeClass('hidden');
                } else {
                    $('#error-login').removeClass('hidden');
                }
            });
            
            // Event handlers
            $('#continue-btn').click(function() {
                $('#announcement-page').addClass('hidden');
                $('#exam-page').removeClass('hidden');
            });
            
            
            $('#prev-btn').click(function() {
                if (currentQuestionIndex > 0) {
                    currentQuestionIndex--;
                    showQuestion(currentQuestionIndex);
                    updateNavigationButtons();
                }
            });
            
            $('#next-btn').click(function() {
                if (currentQuestionIndex < questions.length - 1) {
                    currentQuestionIndex++;
                    showQuestion(currentQuestionIndex);
                    updateNavigationButtons();
                }
            });
            
            $('#info-btn').click(function() {
                $('#mobile-drawer').removeClass('translate-y-full');
            });
            
            $('#close-drawer-btn').click(function() {
                $('#mobile-drawer').addClass('translate-y-full');
            });
            
            $('#end-exam-btn').click(function() {
                $('#confirmation-modal').removeClass('hidden');
            });
            
            $('#cancel-btn').click(function() {
                $('#confirmation-modal').addClass('hidden');
            });
            
            $('#confirm-end-btn').click(function() {
                // Submit ujian dan tampilkan hasil
                submitExam();
                $('#confirmation-modal').addClass('hidden');
            });
            
            $('#back-to-login-btn').click(function() {
                // Reset aplikasi dan kembali ke login
                resetExam();
                $('#result-page').addClass('hidden');
                $('#login-page').removeClass('hidden');
            });
            
            // Tutup panel mobile saat mengklik di luar
            $('#mobile-drawer').click(function(e) {
                if (e.target.id === 'mobile-drawer') {
                    $(this).addClass('translate-y-full');
                }
            });
        });

        // Set informasi siswa
        function setStudentInfo() {
            $('#student-name').text(studentInfo.name);
            $('#class-info').text(studentInfo.class);
            $('#subject-info').text(studentInfo.subject);
            $('#exam-info').text(studentInfo.exam);
            
            $('#result-student-name').text(studentInfo.name);
            $('#result-class').text(studentInfo.class);
            $('#result-subject').text(studentInfo.subject);
            $('#result-exam').text(studentInfo.exam);
        }

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // Generate grid pertanyaan untuk desktop dan mobile
        function generateQuestionGrid() {
            const desktopGrid = $('#questions-grid');
            const mobileGrid = $('#mobile-questions-grid');
            
            desktopGrid.empty();
            mobileGrid.empty();

            shuffleArray(questions);
            
            questions.forEach((question, index) => {
                const questionNumber = index + 1;
                const questionElement = $(`
                    <button class="w-10 h-10 rounded-full border border-gray-300 flex items-center justify-center font-medium question-number-btn ${index === currentQuestionIndex ? 'bg-indigo-100 border-indigo-500 text-indigo-700' : 'text-gray-700'}" data-index="${index}">
                        ${questionNumber}
                    </button>
                `);
                
                desktopGrid.append(questionElement);
                mobileGrid.append(questionElement.clone());
            });
            
            // Tambahkan handler klik ke tombol nomor pertanyaan
            $('.question-number-btn').click(function() {
                const index = parseInt($(this).data('index'));
                currentQuestionIndex = index;
                showQuestion(currentQuestionIndex);
                updateNavigationButtons();
                
                // Tutup panel mobile jika terbuka
                $('#mobile-drawer').addClass('translate-y-full');
            });
        }

        // Tampilkan pertanyaan tertentu
        function showQuestion(index) {
            const question = questions[index];
            
            // Perbarui info pertanyaan
            $('#current-question').text(index + 1);
            $('#question-info').text(`${index + 1}/${questions.length}`);
            $('#question-text').text(question.text);
            
            // Perbarui grid pertanyaan untuk menyorot pertanyaan saat ini
            $('.question-number-btn').removeClass('bg-indigo-100 border-indigo-500 text-indigo-700');
            $(`.question-number-btn[data-index="${index}"]`).addClass('bg-indigo-100 border-indigo-500 text-indigo-700');
            
            // Perbarui pertanyaan yang telah dijawab
            updateAnsweredQuestions();
            
            // Generate opsi
            const optionsContainer = $('#options-container');
            optionsContainer.empty();
            
            question.options.forEach((option, optionIndex) => {
                const isChecked = answers[index] === optionIndex;
                const optionElement = $(`
                    <label for="option-${optionIndex}" class="flex items-center p-3 border border-gray-300 rounded-lg hover:bg-gray-50 cursor-pointer">
                        <input type="radio" id="option-${optionIndex}" name="answer" value="${optionIndex}" class="h-4 w-4 text-indigo-600 focus:ring-indigo-500 peer" ${isChecked ? 'checked' : ''}>
                        <span class="ml-3 block text-gray-700 peer-checked:font-semibold ${isChecked ? 'font-semibold' : ''}">${optionIndex == 0 ? "A. ": optionIndex == 1 ? "B. ":optionIndex == 2 ? "C. ":optionIndex == 3 ? "D. ": "-. "}${option}</span>
                    </label>
                `);
                
                optionsContainer.append(optionElement);
            });
            
            // Tambahkan handler perubahan untuk radio button
            $('input[name="answer"]').change(function() {
                const selectedOption = parseInt($(this).val());
                answers[index] = selectedOption;
                updateAnsweredQuestions();
            });
        }

        // Perbarui state tombol navigasi
        function updateNavigationButtons() {
            $('#prev-btn').prop('disabled', currentQuestionIndex === 0);
            $('#next-btn').prop('disabled', currentQuestionIndex === questions.length - 1);
        }

        // Perbarui pertanyaan yang telah dijawab di grid
        function updateAnsweredQuestions() {
            $('.question-number-btn').each(function() {
                const index = parseInt($(this).data('index'));
                if (answers[index] !== null) {
                    $(this).addClass('bg-green-100 border-green-500 text-green-700');
                } else {
                    $(this).removeClass('bg-green-100 border-green-500 text-green-700');
                }
            });
        }

        // Mulai timer hitung mundur
        function startTimer() {
            updateTimerDisplay();
            
            timerInterval = setInterval(function() {
                timeLeft--;
                updateTimerDisplay();
                
                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    alert('Waktu habis! Ujian Anda akan dikirimkan secara otomatis.');
                    submitExam();
                }
            }, 1000);
        }

        // Perbarui tampilan timer
        function updateTimerDisplay() {
            const minutes = Math.floor(timeLeft / 60);
            const seconds = timeLeft % 60;
            $('#timer').text(`${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`);
        }

        // Submit ujian dan tampilkan hasil
        function submitExam() {
            clearInterval(timerInterval);
            
            // Hitung hasil
            let correctCount = 0;
            let answeredCount = 0;
            
            answers.forEach((answer, index) => {
                if (answer !== null) {
                    answeredCount++;
                    if (answer === questions[index].correctAnswer) {
                        correctCount++;
                    }
                }
            });
            
            const score = Math.round((correctCount / questions.length) * 100);
            
            // Perbarui halaman hasil
            $('#total-questions').text(questions.length);
            $('#answered-questions').text(answeredCount);
            $('#correct-answers').text(correctCount);
            $('#score').text(`${score}%`);
            
            // Generate tinjauan pertanyaan
            generateQuestionReview();
            
            // Tampilkan halaman hasil
            $('#exam-page').addClass('hidden');
            $('#result-page').removeClass('hidden');
        }

        // Generate tinjauan pertanyaan untuk halaman hasil
        function generateQuestionReview() {
            const reviewContainer = $('#question-review');
            reviewContainer.empty();
            
            questions.forEach((question, index) => {
                const userAnswer = answers[index];
                const isCorrect = userAnswer === question.correctAnswer;
                const statusClass = isCorrect ? 'text-green-700' : 'text-red-600';
                const statusText = isCorrect ? 'Benar' : 'Salah';
                
                let userAnswerText = 'Tidak dijawab';
                if (userAnswer !== null) {
                    userAnswerText = question.options[userAnswer];
                }
                
                const correctAnswerText = question.options[question.correctAnswer];
                
                const reviewItem = $(`
                    <div class="border border-gray-300 rounded-lg p-4 ${isCorrect ? 'bg-green-50' : 'bg-red-50'}">
                        <div class="flex justify-between items-start mb-2">
                            <h3 class="font-semibold text-gray-800">Pertanyaan ${index + 1}</h3>
                            <span class="font-medium ${statusClass}">${statusText}</span>
                        </div>
                        <p class="text-gray-700 mb-3">${question.text}</p>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-2 text-sm">
                            <div>
                                <span class="font-medium">Jawaban Anda:</span>
                                <span class="ml-2 ${userAnswer === null ? 'text-gray-500' : (isCorrect ? 'text-green-700' : 'text-red-600')}">${userAnswerText}</span>
                            </div>
                            <div>
                                <span class="font-medium">Jawaban Benar:</span>
                                <span class="ml-2 text-green-700">${correctAnswerText}</span>
                            </div>
                        </div>
                    </div>
                `);
                
                reviewContainer.append(reviewItem);
            });
        }

        // Reset ujian (untuk keperluan demo)
        function resetExam() {
            currentQuestionIndex = 0;
            answers = new Array(questions.length).fill(null);
            timeLeft = 30 * 60;
            
            $('#username').val('');
            $('#password').val('');
            
            clearInterval(timerInterval);
            startTimer();
            shuffleArray(questions);
            showQuestion(currentQuestionIndex);
            updateNavigationButtons();
            updateAnsweredQuestions();
        }
    </script>
</body>
</html>
